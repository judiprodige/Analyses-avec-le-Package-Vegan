<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyses avec le Package Vegan</title>
    <style>
        /* Palette de couleurs naturelles */
        :root {
            --primary-color: #2c6e49; /* Vert forêt */
            --secondary-color: #97bc62; /* Vert clair */
            --background-color: #f3f9f1; /* Blanc verdâtre */
            --text-color: #37423d; /* Gris vert foncé */
            --highlight-color: #f4a261; /* Orange doux */
            --code-bg-color: #e9f5e7; /* Vert pâle */
        }

        body {
            font-family: 'Lora', serif;
            line-height: 1.8;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin: 0;
        }

        section {
            margin: 20px auto;
            max-width: 1000px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: var(--primary-color);
        }

        h3 {
            color: var(--secondary-color);
        }

        p, ul, ol {
            margin-bottom: 20px;
        }

        code {
            background-color: var(--code-bg-color);
            padding: 2px 4px;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
        }

        pre {
            background-color: var(--code-bg-color);
            padding: 10px;
            border-left: 5px solid var(--primary-color);
            border-radius: 5px;
            font-family: 'Courier New', Courier, monospace;
            overflow-x: auto;
        }

        a {
            color: var(--highlight-color);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        footer {
            text-align: center;
            padding: 10px 0;
            background-color: var(--primary-color);
            color: white;
            margin-top: 20px;
        }
        /* Style pour le conteneur du logo */
        .logo-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #2c6e49, #97bc62);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden; /* Pour s'assurer que l'image reste dans le cercle */
        }

        /* Image à l'intérieur du logo */
        .logo-container img {
            width: 100%; /* L'image remplit le conteneur */
            height: 100%;
            object-fit: cover; /* Ajuste l'image pour qu'elle s'adapte */
        }
    </style>
</head>
<body>
    <header>
        <h1>Analyses avec le Package Vegan</h1>
        <p>Le package vegan pour R est un outil essentiel en écologie communautaire, offrant une gamme complète de fonctions pour l’analyse de la diversité, l’ordination et l’étude des dissimilarités. Il est largement utilisé pour des analyses écologiques descriptives et multivariées.</p>
    </header>

    <section>
        <h2>1. Analyse Multivariée Non Contrainte</h2>
        <h3>NMDS (Non-metric Multidimensional Scaling)</h3>
        <p>L’analyse multidimensionnelle non métrique (NMDS) est une méthode d’ordination utilisée pour représenter des relations complexes dans des données multidimensionnelles sous la forme de points dans un espace à faible dimension (souvent 2D ou 3D). Contrairement aux méthodes métriques, la NMDS repose sur les rangs des distances entre les points plutôt que sur leurs valeurs absolues, ce qui la rend adaptée aux données écologiques présentant des structures non linéaires.</p>
        <p>La section suivante présente un extrait de code R pour réaliser une analyse NMDS. Le code inclut la création de graphiques annotés et l’attribution de couleurs et symboles aux groupes pour une meilleure visualisation des résultats</p>
        <pre><code>
# Charger les packages nécessaires
library(vegan)

# Charger l'exemple de données (abondance des espèces)
data(varespec)  # Jeu de données d'abondance d'espèces

# Calcul de la matrice de dissimilarité (méthode de Bray-Curtis adaptée à l'écologie)
dissimilarity_matrix <- vegdist(varespec, method = "bray")

# Réalisation de l'ordination NMDS en utilisant directement les données brutes
nmds_result <- metaMDS(varespec, k = 2, trymax = 100)  # k = 2 pour une projection 2D

# Création de groupes fictifs pour démonstration
set.seed(123)  # Fixer une graine pour la reproductibilité
groupes <- sample(c("Groupe 1", "Groupe 2", "Groupe 3"), nrow(varespec), replace = TRUE)

# Attribution de couleurs et de symboles aux groupes
couleurs <- c("#E41A1C", "#377EB8", "#4DAF4A")  # Couleurs esthétiques (palette ColorBrewer)
symboles <- c(16, 17, 18)  # Différents symboles (cercle, triangle, losange)
couleurs_groupes <- couleurs[as.factor(groupes)]  # Assigner les couleurs selon les groupes
symboles_groupes <- symboles[as.factor(groupes)]  # Assigner les symboles selon les groupes

# Préparer le graphique NMDS avec des ajustements esthétiques
plot(nmds_result, type = "n", main = "NMDS : Ordination avec groupes", xlab = "Dimension 1", ylab = "Dimension 2", bty = "l")  # "bty = 'l'" pour un cadre plus léger
points(nmds_result, display = "sites", col = couleurs_groupes, pch = symboles_groupes, cex = 1.5)  # Points des sites

# Ajouter des labels uniquement pour les espèces les plus pertinentes
species_scores <- scores(nmds_result, display = "species")
if (!is.null(species_scores)) {
  # Sélection des espèces avec une distance importante de l'origine
  species_to_label <- species_scores[rowSums(abs(species_scores)) > quantile(rowSums(abs(species_scores)), 0.75), ]
  text(species_to_label, labels = rownames(species_to_label), col = "darkgray", cex = 0.8)
} else {
  message("Les scores des espèces ne sont pas disponibles.")
}

# Ajouter une légende
legend("topright", legend = levels(as.factor(groupes)), col = couleurs, pch = symboles, title = "Groupes", bty = "n", cex = 0.8)  # "bty = 'n'" pour une légende sans cadre
    # Qualité de l’ajustement (stress)

nmds_result$stress # ceci donne la valeur du stress
stressplot(resultat_nmds) # Permet de visualiser la qualité de l’ajustement (stress)
    
        </code></pre>
      <p>Voici le graphique de l'analyse NMDS, illustrant les relations entre les sites et les groupes :</p>
      <img src="nmds1.png" alt="Graphique NMDS" style="width:100%; max-width:800px; display:block; margin:auto;">

      <p>Pour visualiser la qualité de l’ajustement (stress), on utilise un diagramme de Shepard ou un graphique de stress :</p>
      <img src="nmds2.png" alt="Graphique NMDS" style="width:100%; max-width:800px; display:block; margin:auto;">
      <p> L’évaluation du stress dans une analyse NMDS permet d’estimer la qualité de l’ajustement du modèle aux données. Une valeur de stress inférieure à 0,05 indique un excellent ajustement, une valeur entre 0,05 et 0,1 représente un bon ajustement, tandis qu’une valeur située entre 0,1 et 0,2 correspond à un ajustement acceptable. </p>

        <h3>PCA (Principal Component Analysis)</h3>
        <p>Réduction de la dimensionnalité.</p>
        <pre><code>
data(dune)
mod <- rda(dune ~ 1)
plot(mod)
        </code></pre>
    </section>

    <section>
        <h2>2. Analyse Multivariée Contrainte</h2>
        <h3>RDA (Redundancy Analysis)</h3>
        <p>Étudie les relations entre variables environnementales et espèces.</p>
        <pre><code>
data(dune)
data(dune.env)
mod <- rda(dune ~ Management + Moisture, dune.env)
plot(mod)
        </code></pre>

        <h3>CCA (Canonical Correspondence Analysis)</h3>
        <p>Analyse des relations canoniques.</p>
        <pre><code>
mod <- cca(dune ~ Management + Moisture, dune.env)
plot(mod)
        </code></pre>
        
    </section>

    <section>
        <h2>3. Analyse de la Dispersion Beta</h2>
        <p>Évalue la dispersion au sein et entre groupes.</p>
        <pre><code>
dist <- vegdist(dune)
groups <- dune.env$Management
beta <- betadisper(dist, groups)
anova(beta)
plot(beta)
        </code></pre>
    </section>

    <section>
        <h2>4. Analyse de Similarités (ANOSIM)</h2>
        <p>Test statistique pour comparer les groupes.</p>
        <pre><code>
dune.dist <- vegdist(dune)
anosim_result <- anosim(dune.dist, dune.env$Management)
summary(anosim_result)
plot(anosim_result)
        </code></pre>
    </section>

    <section>
        <h2>5. Analyse de Variance Permutationnelle (PERMANOVA)</h2>
        <h3>adonis2</h3>
        <p>Teste les différences multivariées entre groupes.</p>
        <pre><code>
adonis2(dune ~ Management + Moisture, data = dune.env, method = "bray")
        </code></pre>
    </section>

    <section>
        <h2>6. Partition de la Diversité</h2>
        <h3>Partition additive de la diversité</h3>
        <p>Compare alpha, bêta et gamma diversités.</p>
        <pre><code>
data(mite)
adipart(mite, index = "shannon", nsimul = 99)
        </code></pre>

        <h3>Modèles hiérarchiques</h3>
        <p>Partition de la diversité sur des niveaux hiérarchiques.</p>
        <pre><code>
data(mite)
hiersimu(mite, FUN = diversity, relative = TRUE, nsimul = 99)
        </code></pre>
    </section>

    <section>
        <h2>7. Analyse de Dissimilarités</h2>
        <h3>Test de Mantel</h3>
        <p>Corrélation entre matrices de distances.</p>
        <pre><code>
data(dune)
mantel(vegdist(dune), vegdist(dune.env$Moisture))
        </code></pre>
    </section>

    <section>
        <h2>8. Visualisation et Ajustements</h2>
        <h3>Surfaces et ellipses</h3>
        <p>Ajustement de surfaces sur des ordinations.</p>
        <pre><code>
with(dune.env, ordiellipse(mod, Management, label = TRUE))
ordisurf(mod, diversity(dune), add = TRUE)
        </code></pre>
    </section>

    <section>
        <h2>9. Autres Méthodes Importantes</h2>
        <h3>MRPP (Multi-Response Permutation Procedure)</h3>
        <p>Test non paramétrique pour comparer des groupes.</p>
        <pre><code>
mrpp_result <- mrpp(dune, dune.env$Management)
summary(mrpp_result)
        </code></pre>

        <h3>Cluster Analysis</h3>
        <p>Analyse hiérarchique des regroupements.</p>
        <pre><code>
hc <- hclust(vegdist(dune))
plot(hc)
        </code></pre>

        <h3>Richesse spécifique accumulée</h3>
        <p>Évalue la richesse en espèces.</p>
        <pre><code>
specaccum(dune)
        </code></pre>
    </section>

    <section>
        <h2>10. Statistiques de Biodiversité</h2>
        <h3>Diversité</h3>
        <p>Calcul d’indices de diversité comme Shannon et Simpson.</p>
        <pre><code>
div <- diversity(dune, index = "shannon")
        </code></pre>

        <h3>Rarefaction</h3>
        <p>Comparaison des diversités à des niveaux d’échantillonnage constants.</p>
        <pre><code>
rarefy(dune, sample = 20)
        </code></pre>
    </section>

    <section>
        <h2>11. Tests spécifiques</h2>
        <h3>Permutation test</h3>
        <p>Pour tester la signification des modèles.</p>
        <pre><code>
anova(mod, by = "term")
        </code></pre>
    </section>

    <section>
        <h2>12. Analyses Personnalisées</h2>
        <h3>Simper (Similarity Percentage)</h3>
        <p>Identifie les espèces contribuant le plus aux différences entre groupes.</p>
        <pre><code>
simper(dune, dune.env$Management)
        </code></pre>

        <h3>Analyse des distributions moyennes</h3>
        <pre><code>
avgdist(dune, sample = 20, iterations = 100)
        </code></pre>
    </section>

    <section>
        <h2>13. Fonctions Utilitaires</h2>
        <p>
            • Tracés avancés : <code>ordiplot</code>, <code>ordihull</code>, <code>ordispider</code>.<br>
            • Modifications des matrices de données : <code>decostand</code>, <code>vegdist</code>.<br>
            • Calculs taxonomiques : <code>taxondive</code>.
        </p>
    </section>
    
    <section>
        <h2>Référence</h2>
        <p>Pour plus de détails, consultez la documentation officielle du package Vegan sur CRAN :</p>
        <p>
            <a href="https://cran.r-project.org/web/packages/vegan/vegan.pdf" target="_blank">
                https://cran.r-project.org/web/packages/vegan/vegan.pdf
            </a>
        </p>
    </section>
<footer>
    <p>Merci de votre visite.</p>
    <p>&copy; 2025 - Judicael OSSE </p>
</footer>
    <!-- Conteneur du logo -->
    <div class="logo-container">
        <!-- Image au centre -->
        <img src="logo.jpg" alt="Logo Image">
    </div>
</body>
</html>
